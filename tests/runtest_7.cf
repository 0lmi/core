
body common control

{
bundlesequence  => { "assign"  };
}


bundle agent assign

{     
vars:
     
 "xxx" string => readfile( "/home/mark/tmp/testfile" , "33" );

 "ran" int => randomint(4,88);

 "yyy" slist => { readstringlist("/home/mark/tmp/testlist","#[a-zA-Z0-9 ]*","[^a-zA-Z0-9]",5,4000) };

 "zzz" slist => { readstringlist("/home/mark/tmp/testlist2","#[^\n]*",",",5,4000) };
 "aaa" ilist => { readintlist("/home/mark/tmp/testilist","#[a-zA-Z0-9 ]*","[^a-zA-Z0-9]",5,4000) };

# check limits

classes:

  # got_array is a class that says whether the read was successful
  # array_name[] is the lval

  
"got_array" expression =>  readstringarray("array_name","/etc/passwd","#[^\n]*",":",10,4000);

reports:

  any::

    "Read item from list: $(yyy)";

    "Read this file: [$(xxx)] ...";

}